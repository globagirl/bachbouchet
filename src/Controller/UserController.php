<?php/** * Created by PhpStorm. * User: khaoula * Date: 1/7/2023 * Time: 6:16 PM */namespace App\Controller;use App\Document\contact;use App\Document\Produit;use App\Document\User;use Doctrine\ODM\MongoDB\DocumentManager;use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;use Symfony\Component\Form\Extension\Core\Type\EmailType;use Symfony\Component\Form\Extension\Core\Type\PasswordType;use Symfony\Component\Form\Extension\Core\Type\SubmitType;use Symfony\Component\HttpFoundation\Request;use Symfony\Component\HttpFoundation\Response;use Symfony\Component\Routing\Annotation\Route;/** * @Route("/auth") */class UserController extends AbstractController{    /**     * @Route("/signup", name="signup")     */    public function signup(DocumentManager $dm, Request $request): Response    {        $user = new User();        $user->setEmail('test@tef');        $user->setPassword('12345');        $user->setRoles(['ADM','PAR','HEB']);        $user->setName('aamaar');        $user->setJoin(new \DateTime());        $cont=new contact();        $cont->setAddress('cite **** rue 555');        $cont->setCity('charguia');        $cont->setZipcode('7003');        $cont->setPhone('66 666 666');        $user->setContact($cont);        $dm->persist($user);        $dm->persist($cont);        $dm->flush();        return new Response("ok");/*        //form creation        $form = $this->createFormBuilder($user)            ->add('email',EmailType::class)            ->add('password',PasswordType::class)            ->add('SignUp',SubmitType::class)            ->getForm();        $form->handleRequest($request);        //form action        if ($form->isSubmitted()) {            $produit = $dm->getRepository(Produit::class)->findOneBy(['nom'=> 'Smartphone']);            $user->setProduit($produit);            $dm->persist($user);            $dm->flush();            $this->addFlash(                'notice',                'Subscribed successfully ! '            );            return $this->redirect($this->generateUrl('login'));        }        return $this->render('Auth/signup.html.twig', ["form"=>$form->createView()]);*/}    /**     * @Route("/login", name="login")     */    public function login(DocumentManager $dm, Request $request): Response    {        $user = new User();        //form creation        $form = $this->createFormBuilder($user)            ->add('email',EmailType::class)            ->add('password',PasswordType::class)            ->add('Login',SubmitType::class)            ->getForm();        $form->handleRequest($request);        if ($form->isSubmitted()) {            $user = $dm->getRepository(User::class)->findOneBy(["email"=>$user->getEmail()]);            if ($user){                //TODO:: add session + dashboard page                return $this->redirect($this->generateUrl('home'));            }else{                $this->addFlash(                    'notice',                    'Please verify your entry!'                );            }        }        return $this->render('Auth/login.html.twig', ["form"=>$form->createView()]);    }    /**     * @Route("/logout", name="logout")     */    public function logout(): Response    {        return $this->render('Auth/login.html.twig');    }}